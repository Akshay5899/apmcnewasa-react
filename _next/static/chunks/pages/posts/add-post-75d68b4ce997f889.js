(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{7115:function(t,e,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/add-post",function(){return s(6095)}])},6095:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return c}});var i=s(5893),n=s(9008),l=s.n(n),o=s(7294),r=s(5422),a=s(7927),d=s(1664),p=s.n(d);function c(){let[t,e]=(0,o.useState)(""),[s,n]=(0,o.useState)(""),[d,c]=(0,o.useState)(null),[h,x]=(0,o.useState)(null),[u,g]=(0,o.useState)(""),[f,m]=(0,o.useState)([]),[j,y]=(0,o.useState)(null),w=async()=>{try{let t=await fetch("http://localhost:5000/api/posts"),e=await t.json();m(e)}catch(t){console.error("Error fetching posts:",t)}};(0,o.useEffect)(()=>{w()},[]);let b=async i=>{if(i.preventDefault(),!t||!s)return;let l=new FormData;l.append("title",t),l.append("description",s),d&&l.append("image",d);try{let t=await fetch(j?"http://localhost:5000/api/posts/".concat(j):"http://localhost:5000/api/posts",{method:j?"PUT":"POST",body:l}),s=await t.json();if(!t.ok)throw Error(s.message||"Failed");g(j?"✅ Post updated!":"✅ Post added!"),e(""),n(""),c(null),x(null),y(null),w()}catch(t){console.error(t),g("❌ Error saving post")}},P=t=>{e(t.title),n(t.description),x(t.image?"http://localhost:5000".concat(t.image):null),y(t.id),window.scrollTo({top:0,behavior:"smooth"})},v=async t=>{if(confirm("Delete this post?"))try{await fetch("http://localhost:5000/api/posts/".concat(t),{method:"DELETE"}),w(),j===t&&(e(""),n(""),c(null),x(null),y(null))}catch(t){console.error(t)}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l(),{children:(0,i.jsxs)("title",{children:[j?"Edit Post":"Add Post"," - APMC"]})}),(0,i.jsx)(r.Z,{}),(0,i.jsx)(()=>{let t={color:"#34a853",textDecoration:"none"};return(0,i.jsxs)("section",{style:{background:"#f5f5f5",textAlign:"center",padding:"80px 20px"},children:[(0,i.jsx)("h2",{style:{fontSize:"42px",fontWeight:"700",color:"#000",marginBottom:"10px"},children:j?"Edit Post":"Add Post"}),(0,i.jsxs)("div",{style:{fontSize:"18px"},children:[(0,i.jsx)(p(),{href:"/",style:t,children:"Home"})," /"," ",(0,i.jsx)(p(),{href:"/posts",style:t,children:"Posts"})," /"," ",(0,i.jsx)("strong",{children:j?"Edit Post":"Add Post"})]})]})},{}),(0,i.jsxs)("main",{style:{maxWidth:"800px",margin:"50px auto",textAlign:"center"},children:[(0,i.jsxs)("form",{onSubmit:b,encType:"multipart/form-data",children:[(0,i.jsx)("input",{type:"text",placeholder:"Title",value:t,onChange:t=>e(t.target.value),required:!0,style:{width:"100%",margin:"10px 0",padding:"10px"}}),(0,i.jsx)("textarea",{placeholder:"Description",value:s,onChange:t=>n(t.target.value),rows:"5",required:!0,style:{width:"100%",margin:"10px 0",padding:"10px"}}),(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:t=>{let e=t.target.files[0];c(e),x(URL.createObjectURL(e))}}),h&&(0,i.jsx)("img",{src:h,alt:"preview",style:{width:"100%",marginTop:"10px"}}),(0,i.jsx)("button",{type:"submit",style:{marginTop:"10px",padding:"10px 20px"},children:j?"Update Post":"Add Post"})]}),u&&(0,i.jsx)("p",{children:u}),(0,i.jsx)("hr",{style:{margin:"30px 0"}}),(0,i.jsx)("h3",{children:"All Posts"}),(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"},children:f.map(t=>(0,i.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:"5px",overflow:"hidden"},children:[t.image&&(0,i.jsx)("img",{src:"http://localhost:5000".concat(t.image),style:{width:"100%",height:"150px",objectFit:"cover"},alt:t.title}),(0,i.jsxs)("div",{style:{padding:"10px"},children:[(0,i.jsx)("h4",{children:t.title}),(0,i.jsxs)("p",{children:[t.description.substring(0,100),"..."]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,i.jsx)("button",{onClick:()=>P(t),style:{background:"#f0ad4e",color:"white",padding:"5px 10px"},children:"Edit"}),(0,i.jsx)("button",{onClick:()=>v(t.id),style:{background:"red",color:"white",padding:"5px 10px"},children:"Delete"})]})]})]},t.id))})]}),(0,i.jsx)(a.Z,{})]})}}},function(t){t.O(0,[664,27,888,774,179],function(){return t(t.s=7115)}),_N_E=t.O()}]);