(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[946],{1287:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/media-page/add-photo-gallery",function(){return r(6028)}])},6028:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var o=r(5893),l=r(7294),n=r(7066),i=r(5422),a=r(7927),s=r(1664),d=r.n(s);function c(){let[e,t]=(0,l.useState)(""),[r,s]=(0,l.useState)([]),[c,p]=(0,l.useState)([]),[u,x]=(0,l.useState)(null),[h,g]=(0,l.useState)([]),[b,m]=(0,l.useState)(""),[f,y]=(0,l.useState)(!1),j=(0,l.useRef)(null),v="http://localhost:5000";(0,l.useEffect)(()=>{w()},[]);let w=async()=>{try{let e=await n.Z.get("".concat(v,"/api/albums"));p(e.data)}catch(e){console.error("Error fetching albums:",e)}},k=()=>{t(""),s([]),x(null),g([]),m(""),j.current&&(j.current.value="")},E=async t=>{if(t.preventDefault(),!e.trim()){m("Please enter album title.");return}let o=new FormData;o.append("title",e);for(let e=0;e<r.length;e++)o.append("photos",r[e]);try{y(!0),u?(await n.Z.put("".concat(v,"/api/albums/").concat(u.id),o,{headers:{"Content-Type":"multipart/form-data"}}),m("Album updated successfully!")):(await n.Z.post("".concat(v,"/api/albums"),o,{headers:{"Content-Type":"multipart/form-data"}}),m("Album created successfully!")),k(),w()}catch(e){console.error("Error saving album:",e),m("Error saving album. Check backend logs.")}finally{y(!1)}},C=e=>{x(e),t(e.title),g(e.photos||[]),s([]),m(""),j.current&&(j.current.value="")},A=async e=>{if(confirm("Are you sure you want to delete this album?"))try{await n.Z.delete("".concat(v,"/api/albums/").concat(e)),m("Album deleted successfully!"),w()}catch(e){console.error("Error deleting album:",e),m("Error deleting album.")}},_=async e=>{if(u)try{await n.Z.delete("".concat(v,"/api/albums/").concat(u.id,"/photos/").concat(e)),g(t=>t.filter(t=>t.id!==e)),m("Photo deleted successfully!")}catch(e){console.error("Error deleting photo:",e),m("Error deleting photo.")}},R=e=>e?"".concat(v).concat(e.startsWith("/")?"":"/").concat(e):"/placeholder.png";return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.Z,{}),(0,o.jsxs)("main",{style:{maxWidth:"900px",margin:"50px auto",padding:"0 20px"},children:[(0,o.jsx)("h2",{style:{textAlign:"center",marginBottom:"20px"},children:u?"Edit Photo Gallery":"Add Photo Gallery"}),(0,o.jsx)(d(),{href:"/media-page/photo-gallery",style:{display:"inline-block",marginBottom:"20px",color:"#007bff"},children:"â† Back to Gallery"}),b&&(0,o.jsx)("p",{style:{color:b.includes("successfully")?"green":"red",fontWeight:"bold"},children:b}),(0,o.jsxs)("form",{onSubmit:E,children:[(0,o.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,o.jsx)("label",{children:"Album Title"}),(0,o.jsx)("br",{}),(0,o.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),style:{width:"100%",padding:"8px",marginTop:"5px",borderRadius:"5px",border:"1px solid #ccc"}})]}),(0,o.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,o.jsx)("label",{children:"Upload New Photos"}),(0,o.jsx)("br",{}),(0,o.jsx)("input",{ref:j,type:"file",multiple:!0,accept:"image/*",onChange:e=>s(e.target.files)})]}),u&&h.length>0&&(0,o.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,o.jsx)("label",{children:"Existing Photos"}),(0,o.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"5px"},children:h.map(e=>(0,o.jsxs)("div",{style:{position:"relative"},children:[(0,o.jsx)("img",{src:R(e.url),alt:e.alt||"Photo",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"5px"}}),(0,o.jsx)("button",{type:"button",onClick:()=>_(e.id),style:{position:"absolute",top:2,right:2,background:"rgba(0,0,0,0.6)",color:"#fff",border:"none",borderRadius:"50%",width:"20px",height:"20px",cursor:"pointer",fontSize:"12px",lineHeight:"18px",textAlign:"center"},title:"Delete photo",children:"\xd7"})]},e.id))})]}),(0,o.jsx)("button",{type:"submit",disabled:f,style:{padding:"10px 20px",background:u?"#f39c12":"#34a853",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer",opacity:f?.7:1},children:u?"Update Album":"Add Album"}),u&&(0,o.jsx)("button",{type:"button",onClick:k,style:{padding:"10px 20px",background:"#ccc",color:"#000",border:"none",borderRadius:"5px",cursor:"pointer",marginLeft:"10px"},children:"Cancel"})]}),(0,o.jsx)("h3",{style:{marginTop:"40px"},children:"Existing Albums"}),(0,o.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(260px, 1fr))",gap:"20px",marginTop:"20px"},children:c.length>0?c.map(e=>{var t;return(0,o.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden",background:"#fff",boxShadow:"0 2px 5px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("img",{src:R(e.cover||e.photos&&(null===(t=e.photos[0])||void 0===t?void 0:t.url)),alt:e.title,style:{width:"100%",height:"180px",objectFit:"cover"}}),(0,o.jsxs)("div",{style:{padding:"10px"},children:[(0,o.jsx)("h4",{style:{marginBottom:"10px"},children:e.title}),(0,o.jsx)("button",{onClick:()=>C(e),style:{background:"#f39c12",color:"#fff",border:"none",padding:"6px 10px",borderRadius:"5px",marginRight:"10px",cursor:"pointer"},children:"Edit"}),(0,o.jsx)("button",{onClick:()=>A(e.id),style:{background:"#e74c3c",color:"#fff",border:"none",padding:"6px 10px",borderRadius:"5px",cursor:"pointer"},children:"Delete"})]})]},e.id)}):(0,o.jsx)("p",{children:"No albums found."})})]}),(0,o.jsx)(a.Z,{})]})}}},function(e){e.O(0,[664,66,27,888,774,179],function(){return e(e.s=1287)}),_N_E=e.O()}]);